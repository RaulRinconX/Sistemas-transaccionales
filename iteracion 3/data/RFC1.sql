SELECT proveedores.id_proveedor, 
       SUM(CASE WHEN EXTRACT(YEAR FROM reservas.fecha_inicio) = EXTRACT(YEAR FROM SYSDATE) THEN ofertas.precio ELSE 0 END) AS dinero_recibido_anio_actual,
       SUM(ofertas.precio) AS dinero_recibido_anio_corrido
FROM proveedores
INNER JOIN ofertas ON proveedores.id_proveedor = ofertas.id_operador
INNER JOIN reservas ON ofertas.id_oferta = reservas.id_oferta
WHERE EXTRACT(YEAR FROM reservas.fecha_inicio) >= EXTRACT(YEAR FROM SYSDATE)-1
GROUP BY proveedores.id_proveedor;
--------------------
--- RFC7 --------

SELECT * FROM OFERTAVIVIENDAUNIVERSITARIA;
SELECT * FROM OFERTAHABITACIONMENSUAL;
SELECT * FROM OFERTAHABITACIONDIARIA;
SELECT * FROM OFERTAESPORADICA;
SELECT * FROM OFERTAAPARTAMENTO;
SELECT * FROM CONTRATOS;
SELECT * FROM RESERVAS;
SELECT * FROM INTERESAN;
SELECT * FROM ADICIONALES;
SELECT * FROM OFERTAS;
SELECT * FROM PERSONASJURIDICAS;
SELECT * FROM PERSONASNATURALES;
SELECT * FROM CLIENTES;
SELECT * FROM PROVEEDORES;



CREATE TABLE DINERORECIBIDO (
    DINERO NUMBER,
    ANIO NUMBER,
    IDPROVEEDOR VARCHAR2(20 BYTE),
    CONSTRAINT DINERO_PK PRIMARY KEY (DINERO)
    );
    
DROP TABLE DINERORECIBIDO;

ALTER TABLE DINERORECIBIDO
ADD CONSTRAINT FK_DR_PROVEEDOR
    FOREIGN KEY (IDPROVEEDOR)
    REFERENCES PROVEEDORES(ID_PROVEEDOR)
ENABLE;

---------
